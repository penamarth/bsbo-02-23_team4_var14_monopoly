"""
–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π –∏–≥—Ä—ã "–ú–æ–Ω–æ–ø–æ–ª–∏—è"
–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–¥–∞–Ω–∏—è PROMPT5.md

–î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ–º—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
1. –ü–æ–ª–Ω—ã–π —Ö–æ–¥ –∏–≥—Ä–æ–∫–∞ (–±—Ä–æ—Å–æ–∫ –∫—É–±–∏–∫–æ–≤, –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ, —ç—Ñ—Ñ–µ–∫—Ç—ã –∫–ª–µ—Ç–∫–∏)
2. –ü–æ–∫—É–ø–∫–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏
3. –û–ø–ª–∞—Ç–∞ –∞—Ä–µ–Ω–¥—ã
4. –ü–∞—Ç—Ç–µ—Ä–Ω Strategy: AI —Å —Ä–∞–∑–Ω—ã–º–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º–∏ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π
5. –ü–∞—Ç—Ç–µ—Ä–Ω Observer: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å–±–æ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
"""

import io
import sys

# Fix Windows console encoding issue
if sys.platform == "win32":
    sys.stdout = io.TextIOWrapper(sys.stdout.buffer, encoding="utf-8")
    sys.stderr = io.TextIOWrapper(sys.stderr.buffer, encoding="utf-8")

from game import GameSession


def main():
    """
    –ì–ª–∞–≤–Ω—ã–π –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π
    """

    print("=" * 70)
    print(" " * 20 + "üé≤ –ú–û–ù–û–ü–û–õ–ò–Ø üé≤")
    print("=" * 70)
    print("\n–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ Strategy –∏ Observer")
    print("\n" + "=" * 70 + "\n")

    # === –°–æ–∑–¥–∞–Ω–∏–µ –∏–≥—Ä–æ–≤–æ–π —Å–µ—Å—Å–∏–∏ ===
    game = GameSession()

    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–≥—Ä—ã: 3 –∏–≥—Ä–æ–∫–∞ (1 —á–µ–ª–æ–≤–µ–∫ + 2 AI)
    game_config = {
        "players": [
            {"id": "p1", "name": "–ê–ª–∏—Å–∞", "is_ai": False},
            {"id": "p2", "name": "–ë–æ—Ç–ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–π", "is_ai": True},
            {"id": "p3", "name": "–ë–æ—Ç–ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π", "is_ai": True},
        ],
        "settings": {"starting_balance": 1500},
    }

    game.start(game_config)

    # === –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–∞ Observer ===
    print("\n" + "=" * 70)
    print("–î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø –ü–ê–¢–¢–ï–†–ù–ê OBSERVER")
    print("=" * 70)
    print("\n–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª–µ–π –∫ –∏–≥—Ä–æ–≤—ã–º —Å–æ–±—ã—Ç–∏—è–º...")
    print("- ConsoleLoggerObserver: –≤—ã–≤–æ–¥–∏—Ç –≤—Å–µ —Å–æ–±—ã—Ç–∏—è –≤ –∫–æ–Ω—Å–æ–ª—å")
    print("- StatisticsObserver: —Å–æ–±–∏—Ä–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ –∏–≥—Ä—ã\n")
    print("‚úì –ù–∞–±–ª—é–¥–∞—Ç–µ–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–Ω—ã –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –≤–Ω—É—Ç—Ä–∏ GameSession\n")

    # === –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–∞ Strategy ===
    print("\n" + "=" * 70)
    print("–î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø –ü–ê–¢–¢–ï–†–ù–ê STRATEGY")
    print("=" * 70)
    print("\n–°–æ–∑–¥–∞–Ω–∏–µ AI-–∏–≥—Ä–æ–∫–æ–≤ —Å —Ä–∞–∑–Ω—ã–º–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º–∏:")
    print("- –ë–æ—Ç–ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–π: –º–∏–Ω–∏–º–∏–∑–∏—Ä—É–µ—Ç —Ä–∏—Å–∫–∏, —ç–∫–æ–Ω–æ–º–∏—Ç –¥–µ–Ω—å–≥–∏")
    print("- –ë–æ—Ç–ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π: –º–∞–∫—Å–∏–º–∏–∑–∏—Ä—É–µ—Ç –≤–ª–∞–¥–µ–Ω–∏—è, –∞–∫—Ç–∏–≤–Ω–æ —Å—Ç—Ä–æ–∏—Ç\n")
    print(
        "‚úì AI-–∏–≥—Ä–æ–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–Ω—ã –≤–Ω—É—Ç—Ä–∏ GameSession —Å –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º–∏\n"
    )

    # === –ò–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª: 5 —Ä–∞—É–Ω–¥–æ–≤ ===
    print("\n" + "=" * 70)
    print("–ù–ê–ß–ê–õ–û –î–ï–ú–û-–ò–ì–†–´ (5 —Ä–∞—É–Ω–¥–æ–≤)")
    print("=" * 70)

    max_rounds = 5
    for round_num in range(1, max_rounds + 1):
        print(f"\n{'‚ñà' * 70}")
        print(f"{'‚ñà' * 20} –†–ê–£–ù–î {round_num}/{max_rounds} {'‚ñà' * 20}")
        print(f"{'‚ñà' * 70}\n")

        # –ö–∞–∂–¥—ã–π –∏–≥—Ä–æ–∫ –¥–µ–ª–∞–µ—Ç —Ö–æ–¥ (–ª–æ–≥–∏–∫–∞ AI –≤–Ω—É—Ç—Ä–∏ GameSession)
        for _ in range(len(game.players)):
            game.play_turn()

    # === –í—ã–≤–æ–¥ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ ===
    print("\n" + "=" * 70)
    print("–†–ï–ó–£–õ–¨–¢–ê–¢–´ –î–ï–ú–û–ù–°–¢–†–ê–¶–ò–ò")
    print("=" * 70)

    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Ç Observer
    game.statistics.print_summary()

    # –ò—Ç–æ–≥–æ–≤—ã–µ –±–∞–ª–∞–Ω—Å—ã
    print("\n" + "=" * 70)
    print("–§–ò–ù–ê–õ–¨–ù–´–ï –ë–ê–õ–ê–ù–°–´ –ò–ì–†–û–ö–û–í:")
    print("=" * 70)
    for player in game.players:
        print(
            f"{player.name}: ${player.balance} | –ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏: {len(player.properties)}"
        )

    print("\n" + "=" * 70)
    print("–î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê")
    print("=" * 70)
    print("\n–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–Ω–∏–º–∞–Ω–∏–µ! üé≤\n")


if __name__ == "__main__":
    main()
